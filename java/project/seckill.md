# 秒杀介绍

## 业务特点

1. 定时触发，流量在瞬间突增
2. 秒杀请求中常常只有部分能够成功
3. 秒杀商品数量往往有限，不能超卖，但能接受少卖
4. 不要求立即返回真实下单结果  

## 下单流程

![](https://gitee.com/xiaojihao/pubImage/raw/master/image/java/project/20211225215218.png)



> 秒杀流程-收单  

1. 用户访问秒杀入口，将秒杀请求提交给秒杀平台收单网关，平台对秒杀请求进行前置校验
2. 校验通过后，将下单请求通过缓存/队列/线程池等中间层进行提交，在投递完成同时就给用户返回“排队
   中”
3. 对于前置校验失败的下单请求同步返回秒杀下单失败  

> 秒杀流程-下单 

1. 秒杀订单服务获取中间层的下单请求，进行真实的下单前校验，这里主要进行库存的真实校验
2. 扣减库存（或称锁库存）成功后，发起真实的下单操作。扣减库存（锁库存）与下单操作一般在一个事务域中下单成功后，平台往往会发起消息推送，告知用户下单成功，并引导用户进行支付操作
3. 用户一段时间（如：30mins）没有支付，则订单作废，库存恢复，给其他排队中的用户提供购买机会
4. 如果用户支付成功，则订单状态更新，订单流转到其他子系统，如：物流系统对该支付成功的处理中订单进行发货等后续处理  