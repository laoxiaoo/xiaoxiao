# MySQL 表进行分表

是否需要对 MySQL 表进行分表，并没有一个固定的阈值，而是需要结合**数据量、业务场景、查询性能、硬件资源**等多方面因素综合判断。以下是一些关键考量点和实践建议

1. OLTP 场景（高并发读写）

- 当单表数据量达到 500万~1000万行时，如果出现以下问题，需考虑分表：

  - 普通查询（尤其是全表扫描）变慢。

  - 索引维护成本高（如 `INSERT/UPDATE` 变慢）。

  - 锁竞争加剧（如 MyISAM 表级锁）。

  - 如果表设计较差（如无索引、大字段频繁更新），可能在 **100万行** 就需要分表。

2. OLAP 场景（分析型查询）

- 单表数据量超过 **1亿行** 时，复杂查询（如聚合、JOIN）性能会显著下降，需分表或分区。

## 分表的参考阈值

| **OLTP（交易型）**           | 500万~1000万行          | 高并发下，索引维护和锁竞争成本显著增加。 |
| ---------------------------- | ----------------------- | ---------------------------------------- |
| **OLAP（分析型）**           | 1亿行以上               | 复杂查询效率低，需分区或分表优化。       |
| **大字段表（如 TEXT/BLOB）** | 100万行以上             | 大字段导致页分裂频繁，影响写入性能。     |
| **时间序列数据**             | 按时间范围（如按月/年） | 数据有明显时效性，分表便于归档和清理。   |

## 分表策略

### 水平分表

**按规则分片**：例如用户 ID 取模、时间范围、哈希分片

### 垂直分表

**拆分字段**：将高频访问字段和低频字段拆分到不同表。

### 分区表

**按时间分区**：例如按月分区，自动归档旧数据